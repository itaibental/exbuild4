<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注专转   专转</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<div class="toast-container" id="toastContainer"></div>

<header class="main-app-header">
    <div style="position:absolute; right:20px; top:15px;"><a href="index.html" style="color:white; text-decoration:none; font-size:1.2rem;"> 转</a></div>
    <h1>EXAMBUILDER 4.0</h1>
</header>

<div class="container">
    <!-- Right Panel: Global Settings Only -->
    <div class="col-panel col-right" id="rightPanel">
        <div class="resizer resizer-right-col" id="dragHandleRight"></div>
        <div class="scroll-content">
            <h2>锔 专转 </h2>
            
            <div class="form-group">
                <label>驻专 </label>
                <input type="text" id="examTitleInput" placeholder="转专转 " oninput="App.updateExamTitle()" style="margin-bottom: 1vh;">
                <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
                     <label for="schoolLogoInput" style="margin:0; cursor:pointer;" class="btn-secondary-small">
                        <i class="fas fa-image"></i> 注转 
                     </label>
                     <input type="file" id="schoolLogoInput" accept="image/*" onchange="App.handleLogoUpload(event)" style="display:none;">
                     <span id="logoStatus" style="font-size:0.8rem; color:#bdc3c7;"> </span>
                </div>
            </div>

            <details class="editor-category" open>
                <summary>专转 注专转</summary>
                <div class="form-group">
                    <div style="display:flex; gap:1vw; margin-bottom:1vh;">
                        <div style="flex:1">
                            <label for="examDurationInput" style="font-size: 0.8rem;"> (拽转)</label>
                            <input type="number" id="examDurationInput" value="90" min="1">
                        </div>
                        <div style="flex:1">
                            <label for="unlockCodeInput" style="font-size: 0.8rem;">拽 专</label>
                            <input type="text" id="unlockCodeInput" value="1234">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>砖</label>
                    <input type="email" id="teacherEmailInput" placeholder=" 专" style="margin-bottom: 5px;">
                    <input type="text" id="driveFolderInput" placeholder="拽砖专 转拽转 Drive">
                </div>
            </details>

            <details class="editor-category">
                <summary> 驻转专</summary>
                <div class="form-group">
                    <input type="file" id="solutionFileInput" accept=".html,.htm" onchange="App.handleSolutionUpload(event)">
                    <small style="color:#bdc3c7; font-size:0.75rem;">拽抓  爪 专  拽.</small>
                </div>
            </details>

            <div class="stats-box">
                <h3>住 拽</h3>
                <div id="statsContainer"></div>
                <div class="stat-row total-row"><span>住":</span> <span id="totalPoints">0</span></div>
            </div>
        </div>
    </div>

    <!-- Middle Panel: The Main Editor Canvas -->
    <div class="col-middle">
        
        <!-- Sticky Editor Toolbar -->
        <div class="sticky-toolbar">
            <span class="toolbar-label">注爪:</span>
            <button onmousedown="event.preventDefault(); App.applyFormat('b')" title="砖 (B)"><i class="fas fa-bold"></i></button>
            <button onmousedown="event.preventDefault(); App.applyFormat('u')" title="拽 转转 (U)"><i class="fas fa-underline"></i></button>
            <button onmousedown="event.preventDefault(); App.applyFormat('i')" title=" (I)"><i class="fas fa-italic"></i></button>
            <div class="separator"></div>
            <button onmousedown="event.preventDefault(); App.addNewQuestionToCurrentPart()" title="住祝 砖 砖" style="background:#e8f6f3; border-color:#1abc9c; color:#16a085; font-weight:bold;">
                <i class="fas fa-plus-circle"></i> 砖 砖
            </button>
        </div>

        <div id="questionsList">
            <!-- Header Area -->
            <div id="previewHeader">
                <img id="previewLogo" src="" alt="School Logo" style="display:none;">
                <h1 id="previewExamTitle" style="cursor: text;" title="抓 注专 住专 "> 专转</h1>
                <input type="text" id="studentNameInput" placeholder="砖 转 (驻注 )" disabled style="opacity:0.6; cursor: not-allowed;">
            </div>

            <!-- General Instructions Editor -->
            <div class="editor-section">
                <label class="section-label">转 转 :</label>
                <textarea id="examInstructions" class="editable-textarea instructions-editor" placeholder="专砖  转 转  (砖: 专 注专 转专, 砖 ...)" oninput="App.updateGeneralInstructions(this.value)"></textarea>
            </div>

            <!-- Tabs / Parts Manager -->
            <div class="parts-manager">
                <div class="tabs" id="previewTabs"></div>
                <button class="btn-icon-add" onclick="App.addPart()" title="住祝 驻专拽 砖"><i class="fas fa-plus"></i></button>
            </div>

            <!-- Current Part Content -->
            <div id="currentPartEditor">
                <!-- Part Header Editor -->
                <div class="part-header-editor">
                    <input type="text" id="partNameEditor" class="part-name-input" placeholder="砖 驻专拽 (砖: 驻专拽 专砖)" oninput="App.updatePartNameInternal(this.value)">
                    <div style="flex-grow:1"></div>
                    <button class="btn-delete-part" onclick="App.removePart()" title="拽 驻专拽 "><i class="fas fa-trash"></i> 拽 驻专拽</button>
                </div>

                <textarea id="previewPartInstructions" class="editable-textarea part-instructions-editor" placeholder="转 驻专拽  (砖: 注 注 2 转 3 砖转)..." oninput="App.updatePartInstructionsFromPreview(this.value)"></textarea>

                <!-- Questions List (Dynamic) -->
                <div id="previewQuestionsContainer" class="questions-stream"></div>

                <!-- Add Question Button -->
                <div class="add-question-area">
                    <button class="btn-add-big" onclick="App.addNewQuestionToCurrentPart()">
                        <i class="fas fa-plus-circle"></i> 住祝 砖 砖
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Left Panel: Actions -->
    <div class="col-panel col-left" id="leftPanel">
        <div class="resizer resizer-left-col" id="dragHandleLeft"></div>
        <div class="scroll-content">
            <div style="margin-top: 5vh; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 3vh; margin-bottom: 3vh;">
                <h3> 砖专 注</h3>
                <button class="btn-download" style="background: #2c3e50; border: 1px solid #34495e; margin-bottom: 10px;" onclick="App.saveProject()">砖专  (JSON)</button>
                <button class="btn-download" style="background: #2c3e50; border: 1px solid #34495e;" onclick="document.getElementById('projectFileInput').click()">注  拽抓</button>
                <input type="file" id="projectFileInput" accept=".json, .html" style="display: none;" onchange="App.handleProjectLoad(event)">
            </div>
            <div style="text-align: center;">
                <h2> 住 驻爪</h2>
                <div class="file-info">砖 拽抓 砖专:<br><strong id="filenamePreview" style="color: var(--accent); font-size:1.1rem;"> - 转.html</strong></div>
                <!-- Preview Button Added Here -->
                <button class="btn-download" style="background: #8e44ad; margin-bottom: 15px; border:1px solid #7d3c98;" onclick="Generator.previewExam()">
                    <i class="fas fa-eye"></i> 转爪 拽 (转)
                </button>
                <button class="btn-download" onclick="Generator.generateAndDownload()">专  (HTML)</button>
                <button class="btn-download" style="background: #2980b9; margin-top: 15px;" onclick="Generator.generateAndDownloadDocx()">专 -DOCX (驻转专)</button>
            </div>
        </div>
    </div>
</div>

<footer class="main-footer">
    EXAMBUILDER 4.0 &copy; 2026
</footer>

<script src="js/state.js"></script>
<script src="js/utils.js"></script>
<script src="js/ui.js"></script>
<script src="js/generator-html.js"></script>
<script src="js/generator-docx.js"></script>
<script src="js/generator.js"></script>
<script src="js/main.js"></script>
</body>
</html>